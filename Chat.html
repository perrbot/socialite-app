<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Socialite - Elevate your vibe with luxury conversations and connected communities. ðŸ’Žâœ¨ #SocialiteGlowUp" />
  <title>Socialite - Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" onerror="this.href='';document.body.style.fontFamily='sans-serif';">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif; min-height: 100vh; display: flex; justify-content: center; align-items: center;
      background: linear-gradient(135deg, #4C51BF, #ED64A6, #9F7AEA); overflow: hidden;
    }
    .chat-header { background: rgba(255, 255, 255, 0.25); backdrop-filter: blur(12px); padding: 4vw; font-size: min(6vw, 20px); text-align: center; box-shadow: 0 3px 12px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: space-between; }
    .friend-profile { display: flex; align-items: center; gap: 2vw; }
    .friend-avatar { width: 50px; height: 50px; border-radius: 50%; background: #ED64A6; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
    .friend-info { text-align: left; }
    .friend-name { font-size: 1.2em; margin: 0; }
    .friend-status { font-size: 0.9em; margin: 0; opacity: 0.8; }
    .chat-box { padding: 4vw; height: calc(100vh - 26vh); overflow-y: auto; }
    .message { margin-bottom: 3vh; padding: 3vw; border-radius: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.2); max-width: 70%; position: relative; }
    .message.you { background: rgba(255, 255, 255, 0.3); color: #FFF; text-align: right; margin-left: 30%; }
    .message.other { background: rgba(255, 255, 255, 0.2); color: #FFF; margin-right: 30%; }
    .message::before { content: ''; position: absolute; width: 0; height: 0; border: 12px solid transparent; }
    .message.you::before { border-left-color: rgba(255, 255, 255, 0.3); right: -12px; top: 12px; }
    .message.other::before { border-right-color: rgba(255, 255, 255, 0.2); left: -12px; top: 12px; }
    .input-area {
      position: fixed; bottom: 12vh; left: 0; right: 0; padding: 3vw;
      background: rgba(255, 255, 255, 0.25); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.4);
      display: flex; gap: 2vw; box-shadow: 0 -3px 12px rgba(0,0,0,0.3); z-index: 5;
    }
    .input-area input {
      flex: 1; padding: 3vw; border-radius: 25px; border: none; background: rgba(255, 255, 255, 0.2); color: #FFF; font-size: 4vw;
      transition: all 0.3s ease;
    }
    .input-area input:focus { outline: none; background: rgba(255, 255, 255, 0.35); box-shadow: 0 0 20px rgba(159, 122, 234, 0.7); }
    .input-area button {
      background: linear-gradient(45deg, #ED64A6, #4C51BF); color: #FFF; border: none; padding: 3vw; width: 10vw; min-width: 48px; height: 10vw; min-height: 48px;
      border-radius: 50%; font-size: 5vw; cursor: pointer; transition: all 0.4s ease; box-shadow: 0 0 15px rgba(237, 100, 166, 0.6);
    }
    .input-area button:hover { transform: scale(1.15); box-shadow: 0 0 25px rgba(237, 100, 166, 0.9); }
    .input-area button:focus { outline: 2px solid #9F7AEA; outline-offset: 2px; }
    .loading { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #FFF; font-size: 5vw; display: none; animation: blink 1s infinite; }
    @media (max-width: 480px) {
      .chat-header { font-size: 7vw; padding: 3vw; }
      .chat-box { height: calc(100vh - 28vh); padding: 3vw; }
      .message { padding: 2.5vw; }
      .input-area { padding: 2.5vw; bottom: 14vh; }
      .input-area input { font-size: 4.5vw; padding: 2.5vw; }
      .input-area button { font-size: 6vw; width: 12vw; height: 12vw; }
    }
    @keyframes blink { 50% { opacity: 0.5; } }
    body.dark-mode { background: linear-gradient(135deg, #2D3748, #4A5568, #718096); }
    body.dark-mode .message.you { background: rgba(200, 200, 200, 0.3); }
    body.dark-mode .message.other { background: rgba(200, 200, 200, 0.2); }
    body.dark-mode .input-area input { background: rgba(200, 200, 200, 0.2); }
    body.dark-mode .input-area button { background: linear-gradient(45deg, #9F7AEA, #667EEA); }
  </style>
</head>
<body>
  <div class="chat-header" role="banner">
    <div class="friend-profile" id="friendProfile">
      <div class="friend-avatar" id="friendAvatar">?</div>
      <div class="friend-info">
        <p class="friend-name" id="friendName">Socialite Chat</p>
        <p class="friend-status" id="friendStatus">Online</p>
      </div>
    </div>
  </div>
  <div class="chat-box" id="chatBox" aria-live="polite">
    <div class="message other">Hello ðŸ‘‹</div>
    <div class="message you">Hi, how are you?</div>
  </div>
  <div class="input-area">
    <input type="text" id="chatInput" placeholder="Type your message..." aria-label="Chat input">
    <button onclick="sendMessage()" aria-label="Send message"><i class="fas fa-paper-plane"></i></button>
  </div>
  <div class="loading" id="loading">Loading...</div>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js" async></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js" async></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-analytics-compat.js" async></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDdfcTtRD-HdvB_n_colrUWQI-FUZAiNh0",
      authDomain: "socialite-bae96.firebaseapp.com",
      projectId: "socialite-bae96",
      storageBucket: "socialite-bae96.firebasestorage.app",
      messagingSenderId: "871563265567",
      appId: "1:871563265567:web:60b88ac1688f8af3ae372a",
      measurementId: "G-5LN8406TPX"
    };

    let app, auth, analytics;
    document.getElementById('loading').style.display = 'block';
    setTimeout(() => {
      try {
        if (!window.firebaseApp) {
          app = firebase.initializeApp(firebaseConfig);
          auth = firebase.auth();
          analytics = firebase.analytics(app);
          window.firebaseApp = app;
        } else {
          app = window.firebaseApp;
          auth = firebase.auth();
          analytics = firebase.analytics(app);
        }
        document.getElementById('loading').style.display = 'none';
        auth.onAuthStateChanged((user) => {
          if (!user) window.location.replace('login.html');
        });
      } catch (e) {
        console.error("Firebase initialization failed:", e);
        document.getElementById('loading').textContent = 'Retry in progress...';
        setTimeout(() => location.reload(), 2000);
      }
    }, 5000);

    function loadFriendProfile() {
      const urlParams = new URLSearchParams(window.location.search);
      const friendId = urlParams.get('friend');
      if (friendId) {
        // Mock friend data - in real app, fetch from backend
        const friends = [
          { id: 1, displayName: 'Alice Johnson', email: 'alice@example.com', status: 'online' },
          { id: 2, displayName: 'Bob Smith', email: 'bob@example.com', status: 'offline' },
          { id: 3, displayName: 'Charlie Brown', email: 'charlie@example.com', status: 'online' },
          { id: 4, displayName: 'Diana Prince', email: 'diana@example.com', status: 'away' }
        ];
        const friend = friends.find(f => f.id == friendId);
        if (friend) {
          document.getElementById('friendName').textContent = friend.displayName;
          document.getElementById('friendStatus').textContent = friend.status;
          document.getElementById('friendAvatar').textContent = friend.displayName.charAt(0);
        }
      }
    }

    function sendMessage() {
      const input = document.getElementById("chatInput");
      const chatBox = document.getElementById("chatBox");
      if (input.value.trim()) {
        const msg = document.createElement("div");
        msg.className = "message you";
        msg.textContent = input.value;
        chatBox.appendChild(msg);
        input.value = "";
        chatBox.scrollTop = chatBox.scrollHeight;
        analytics.logEvent('chat_message_sent');
      }
    }

    if (localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode');
  </script>
</body>
</html>